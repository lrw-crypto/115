<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>115學年度機械群01甄選入學查詢系統（PDF全面校正版）</title>

  <!-- React & ReactDOM -->
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <!-- Babel for JSX -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- FontAwesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

  <style>
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
  </style>
</head>

<body class="bg-slate-50">
  <div id="root"></div>

  <script type="text/babel">
    /*************************************************
     * A) 你提供的資料（原封不動保留為 Raw）
     *************************************************/
    const mechanicalDataRaw = [
      {
          "id": "701001", "school": "國立中山大學", "dept": "機械與機電工程學系",
          "ratios": { "chi": 0, "eng": 4, "math": 4, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一專二(26)", "英文(10)", "數學(13)"],
          "extraTiebreakers": ["級分和(55)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 5
      },
      {
          "id": "107006", "school": "國立虎尾科技大學", "dept": "機械與電腦輔助工程系",
          "ratios": { "chi": 0, "eng": 4, "math": 4, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(6)", "專二(10)"],
          "extraTiebreakers": ["級分和(41)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 35
      },
      {
          "id": "107008", "school": "國立虎尾科技大學", "dept": "材料科學與工程系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(5)", "國文(8)", "專二(9)", "專一(8)", "國文(5)", "英文(4)"],
          "extraTiebreakers": ["級分和(35)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 28
      },
      {
          "id": "107001", "school": "國立虎尾科技大學", "dept": "機械設計工程系",
          "ratios": { "chi": 0, "eng": 4, "math": 4, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一(8)", "專二(7)"],
          "extraTiebreakers": ["級分和(35)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 42
      },
      {
          "id": "107005", "school": "國立虎尾科技大學", "dept": "動力機械工程系",
          "ratios": { "chi": 0, "eng": 0, "math": 5, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(2)", "專二(10)", "專一(7)"],
          "extraTiebreakers": ["級分和(31)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": false, "pro1": true, "pro2": true },
          "quota": 30
      },
      {
          "id": "107009", "school": "國立虎尾科技大學", "dept": "自動化工程系",
          "ratios": { "chi": 3, "eng": 0, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(8)", "專一(9)"],
          "extraTiebreakers": ["級分和(42)"],
          "tiebreakerV": { "chi": true, "eng": false, "math": true, "pro1": true, "pro2": true },
          "quota": 30
      },
      {
          "id": "107011", "school": "國立虎尾科技大學", "dept": "飛機工程系機械組",
          "ratios": { "chi": 0, "eng": 4, "math": 4, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["英文數學(17)", "專一專二(20)"],
          "extraTiebreakers": ["級分和(38)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 30
      },
      {
          "id": "107012", "school": "國立虎尾科技大學", "dept": "飛機工程系機械組(1)",
          "ratios": { "chi": 0, "eng": 4, "math": 4, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["英文數學(18)", "專一專二(17)"],
          "extraTiebreakers": ["級分和(39)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 5
      },
      {
          "id": "107020", "school": "國立虎尾科技大學", "dept": "工業管理系",
          "ratios": { "chi": 0, "eng": 4, "math": 0, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(5)", "國文(9)", "專二(10)"],
          "extraTiebreakers": ["級分和(37)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 40
      },
      {
          "id": "107099", "school": "國立虎尾科技大學", "dept": "臥虎專班(願景計畫)",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["無資料"],
          "extraTiebreakers": ["無"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 3
      },
      {
          "id": "703001", "school": "國立金門大學", "dept": "運動與休閒學系",
          "ratios": { "chi": 3, "eng": 3, "math": 0, "pro1": 0, "pro2": 0 }, "change": "無變更",
          "screening": ["無資料"],
          "tiebreakerV": { "chi": false, "eng": false, "math": false, "pro1": false, "pro2": false },
          "quota": 2
      },
      {
          "id": "738024", "school": "國立屏東大學", "dept": "智慧機器人學系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一(7)", "數學(5)", "國文(10)"],
          "extraTiebreakers": ["級分和(41)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 5
      },
      {
          "id": "103001", "school": "國立屏東科技大學", "dept": "機械工程系",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(5)", "英文(6)", "專一(6)", "專二(10)"],
          "extraTiebreakers": ["級分和(29)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 45
      },
      {
          "id": "103003", "school": "國立屏東科技大學", "dept": "生物機電工程系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一專二(15)", "英文(7)", "數學(9)"],
          "extraTiebreakers": ["級分和(35)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 30
      },
      {
          "id": "103013", "school": "國立屏東科技大學", "dept": "材料工程系",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專二(10)", "數學(9)"],
          "extraTiebreakers": ["級分和(38)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 38
      },
      {
          "id": "103099", "school": "國立屏東科技大學", "dept": "智慧機電學士學位學程",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一專二(16)", "英文(7)", "國文(8)", "數學(6)"],
          "extraTiebreakers": ["級分和(29)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 35
      },
      {
          "id": "105005", "school": "國立高雄科技大學", "dept": "工業工程與管理系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(10)"],
          "extraTiebreakers": ["級分和(42)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 40
      },
      {
          "id": "105001", "school": "國立高雄科技大學", "dept": "機械工程系",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 2, "pro2": 2 }, "change": "無變更",
          "screening": ["英文(11)", "數學(10)", "專一(10)"],
          "extraTiebreakers": ["級分和(44)"],
          "tiebreakerV": { "chi": true, "eng": false, "math": true, "pro1": true, "pro2": true },
          "quota": 55
      },
      {
          "id": "105002", "school": "國立高雄科技大學", "dept": "機械工程系智能系統與控制組",
          "ratios": { "chi": 3, "eng": 0, "math": 3, "pro1": 2, "pro2": 2 }, "change": "無變更",
          "screening": ["英文(11)", "專一(9)", "數學(9)"],
          "extraTiebreakers": ["級分和(41)"],
          "tiebreakerV": { "chi": true, "eng": false, "math": true, "pro1": true, "pro2": true },
          "quota": 45
      },
      {
          "id": "105003", "school": "國立高雄科技大學", "dept": "機械工程系微奈米技術組",
          "ratios": { "chi": 3, "eng": 0, "math": 3, "pro1": 2, "pro2": 2 }, "change": "無變更",
          "screening": ["數學(9)", "英文(10)", "專一(9)"],
          "extraTiebreakers": ["級分和(41)"],
          "tiebreakerV": { "chi": true, "eng": false, "math": true, "pro1": true, "pro2": true },
          "quota": 45
      },
      {
          "id": "105012", "school": "國立高雄科技大學", "dept": "模具工程系",
          "ratios": { "chi": 3, "eng": 0, "math": 0, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(7)", "英文(10)", "專一專二(20)"],
          "extraTiebreakers": ["級分和(38)"],
          "tiebreakerV": { "chi": true, "eng": false, "math": true, "pro1": true, "pro2": true },
          "quota": 48
      },
      {
          "id": "105013", "school": "國立高雄科技大學", "dept": "模具工程系光電模具組",
          "ratios": { "chi": 3, "eng": 0, "math": 0, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["英文(7)", "數學(7)", "專一專二(19)"],
          "extraTiebreakers": ["級分和(40)"],
          "tiebreakerV": { "chi": true, "eng": false, "math": true, "pro1": true, "pro2": true },
          "quota": 48
      },
      {
          "id": "105014", "school": "國立高雄科技大學", "dept": "模具工程系精微模具組",
          "ratios": { "chi": 3, "eng": 0, "math": 0, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(7)", "英文(8)", "專一專二(19)"],
          "extraTiebreakers": ["級分和(38)"],
          "tiebreakerV": { "chi": true, "eng": false, "math": true, "pro1": true, "pro2": true },
          "quota": 48
      },
      {
          "id": "105021", "school": "國立高雄科技大學", "dept": "機電工程系精密機械組",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 2, "pro2": 2 }, "change": "無變更",
          "screening": ["數學(10)", "專一專二(21)"],
          "extraTiebreakers": ["級分和(44)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 45
      },
      {
          "id": "105022", "school": "國立高雄科技大學", "dept": "機電工程系智動化組",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 2, "pro2": 2 }, "change": "無變更",
          "screening": ["專一專二(13)", "數學(13)"],
          "extraTiebreakers": ["級分和(49)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 45
      },
      {
          "id": "105030", "school": "國立高雄科技大學", "dept": "能源與冷凍空調工程系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一專二(20)", "英文(9)", "國文(11)", "數學(8)"],
          "extraTiebreakers": ["無"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 45
      },
      {
          "id": "105040", "school": "國立高雄科技大學", "dept": "車輛工程系",
          "ratios": { "chi": 3, "eng": 0, "math": 3, "pro1": 2, "pro2": 2 }, "change": "無變更",
          "screening": ["英文(12)", "專一專二(18)", "專二(10)", "數學(8)"],
          "extraTiebreakers": ["無"],
          "tiebreakerV": { "chi": true, "eng": false, "math": true, "pro1": true, "pro2": true },
          "quota": 45
      },
      {
          "id": "105090", "school": "國立高雄科技大學", "dept": "工業設計系",
          "ratios": { "chi": 3, "eng": 3, "math": 0, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["國文(10)", "英文(13)"],
          "extraTiebreakers": ["級分和(42)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": false, "pro1": true, "pro2": true },
          "quota": 38
      },
      {
          "id": "105100", "school": "國立高雄科技大學", "dept": "造船及海洋工程系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一專二(18)"],
          "extraTiebreakers": ["級分和(40)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 35
      },
      {
          "id": "105118", "school": "國立高雄科技大學", "dept": "航運技術系",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專二(9)", "英文(11)", "專一專二(17)"],
          "extraTiebreakers": ["級分和(34)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 30
      },
      {
          "id": "105119", "school": "國立高雄科技大學", "dept": "輪機工程系",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["英文數學(18)"],
          "extraTiebreakers": ["級分和(35)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 30
      },
      {
          "id": "105120", "school": "國立高雄科技大學", "dept": "高瞻科技不分系學士學位學程",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 0 }, "change": "無變更",
          "screening": ["專二(10)", "英文(10)", "國文(10)"],
          "extraTiebreakers": ["級分和(35)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": false },
          "quota": 40
      },
      {
          "id": "707001", "school": "國立清華大學", "dept": "動力機械工程學系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["英文數學(29)", "專一專二(29)"],
          "extraTiebreakers": ["級分和(69)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 10
      },
      {
          "id": "702001", "school": "國立陽明交通大學", "dept": "機械工程學系",
          "ratios": { "chi": 0, "eng": 4, "math": 4, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["英文數學(29)", "專一專二(29)"],
          "extraTiebreakers": ["級分和(58)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 5
      },
      {
          "id": "102001", "school": "國立雲林科技大學", "dept": "機械工程系",
          "ratios": { "chi": 5, "eng": 5, "math": 5, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["英文(9)", "數學(10)", "專二(11)", "專一(10)"],
          "extraTiebreakers": ["級分和(55)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 38
      },
      {
          "id": "102005", "school": "國立雲林科技大學", "dept": "環境與安全衛生工程系",
          "ratios": { "chi": 0, "eng": 5, "math": 5, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["英文(11)", "數學(10)", "專一專二(21)"],
          "extraTiebreakers": ["無"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 30
      },
      {
          "id": "102003", "school": "國立雲林科技大學", "dept": "營建工程系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["英文數學(20)", "專一專二(24)"],
          "extraTiebreakers": ["無"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 30
      },
      {
          "id": "102020", "school": "國立雲林科技大學", "dept": "工業工程與管理系",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專二(12)", "國文(10)"],
          "extraTiebreakers": ["級分和(44)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 35
      },
      {
          "id": "102010", "school": "國立雲林科技大學", "dept": "工業設計系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一(10)", "國文(11)", "英文(13)", "專二(11)"],
          "extraTiebreakers": ["無"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 25
      },
      {
          "id": "102099", "school": "國立雲林科技大學", "dept": "智慧機器人學士學位學程",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一(11)", "數學(10)", "國文(12)", "英文(10)", "專二(13)"],
          "extraTiebreakers": ["級分和(59)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 30
      },
      {
          "id": "110001", "school": "國立勤益科技大學", "dept": "機械工程系",
          "ratios": { "chi": 0, "eng": 5, "math": 5, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一(5)", "數學(5)", "專二(10)"],
          "extraTiebreakers": ["級分和(32)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 50
      },
      {
          "id": "110005", "school": "國立勤益科技大學", "dept": "冷凍空調與能源系能源應用組",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(5)", "專二(9)"],
          "extraTiebreakers": ["級分和(46)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 40
      },
      {
          "id": "110006", "school": "國立勤益科技大學", "dept": "冷凍空調與能源系環境控制組",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(4)", "專二(10)"],
          "extraTiebreakers": ["級分和(34)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 40
      },
      {
          "id": "110020", "school": "國立勤益科技大學", "dept": "工業工程與管理系",
          "ratios": { "chi": 3, "eng": 0, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["國文數學(16)", "專一專二(16)"],
          "extraTiebreakers": ["級分和(32)"],
          "tiebreakerV": { "chi": true, "eng": false, "math": true, "pro1": true, "pro2": true },
          "quota": 40
      },
      {
          "id": "110099", "school": "國立勤益科技大學", "dept": "智慧自動化工程系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 0 }, "change": "無變更",
          "screening": ["國文(10)", "專一專二(19)"],
          "extraTiebreakers": ["級分和(36)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": false },
          "quota": 45
      },
      {
          "id": "713001", "school": "國立彰化師範大學", "dept": "電機與機械科技學系",
          "ratios": { "chi": 4, "eng": 4, "math": 4, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一專二(18)"],
          "extraTiebreakers": ["級分和(51)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 2
      },
      {
          "id": "104001", "school": "國立臺北科技大學", "dept": "機械工程系",
          "ratios": { "chi": 6, "eng": 6, "math": 6, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["英文數學(24)", "專一專二(15)"],
          "extraTiebreakers": ["級分和(60)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 50
      },
      {
          "id": "104005", "school": "國立臺北科技大學", "dept": "能源與冷凍空調工程系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一(13)", "英文數學(26)"],
          "extraTiebreakers": ["無"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 45
      },
      {
          "id": "104008", "school": "國立臺北科技大學", "dept": "材料及資源工程系材料組",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一(12)", "英文(14)"],
          "extraTiebreakers": ["級分和(50)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 25
      },
      {
          "id": "104009", "school": "國立臺北科技大學", "dept": "材料及資源工程系資源組",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["英文(13)", "英文數學(25)", "專一(11)"],
          "extraTiebreakers": ["級分和(51)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 25
      },
      {
          "id": "104020", "school": "國立臺北科技大學", "dept": "工業工程與管理系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專二(12)", "專一專二(19)"],
          "extraTiebreakers": ["級分和(58)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 30
      },
      {
          "id": "114001", "school": "國立臺北商業大學", "dept": "創意科技與產品設計系(桃園校區)",
          "ratios": { "chi": 3, "eng": 0, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一(8)", "專二(12)"],
          "extraTiebreakers": ["級分和(38)"],
          "tiebreakerV": { "chi": true, "eng": false, "math": true, "pro1": true, "pro2": true },
          "quota": 35
      },
      {
          "id": "111001", "school": "國立臺北護理健康大學", "dept": "運動保健系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["國文英文(10)", "專一專二(16)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 5
      },
      {
          "id": "503001", "school": "國立臺東專科學校", "dept": "動力機械科產業機械組",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專二(5)", "國文(5)"],
          "extraTiebreakers": ["級分和(22)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 40
      },
      {
          "id": "503002", "school": "國立臺東專科學校", "dept": "動力機械科車輛組",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一專二(10)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 40
      },
      {
          "id": "101001", "school": "國立臺灣科技大學", "dept": "機械工程系",
          "ratios": { "chi": 6, "eng": 4, "math": 4, "pro1": 2, "pro2": 2 }, "change": "無變更",
          "screening": ["英文數學(25)", "專一專二(25)"],
          "extraTiebreakers": ["級分和(66)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 40
      },
      {
          "id": "101003", "school": "國立臺灣科技大學", "dept": "材料科學與工程系",
          "ratios": { "chi": 3, "eng": 4, "math": 3, "pro1": 2, "pro2": 2 }, "change": "無變更",
          "screening": ["專一專二(25)", "英文數學(27)", "國文(12)"],
          "extraTiebreakers": ["級分和(65)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 6
      },
      {
          "id": "704001", "school": "國立臺灣師範大學", "dept": "機電工程學系",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["國文(11)", "英文數學(23)", "專一專二(25)"],
          "extraTiebreakers": ["級分和(51)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 5
      },
      {
          "id": "705001", "school": "國立臺灣海洋大學", "dept": "機械與機電工程學系",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一(11)", "專二(12)", "英文(13)", "數學(10)"],
          "extraTiebreakers": ["級分和(30)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 5
      },
      {
          "id": "724001", "school": "國立聯合大學", "dept": "機械工程學系",
          "ratios": { "chi": 3, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["專一專二(15)", "數學(8)"],
          "tiebreakerV": { "chi": true, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 22
      },
      {
          "id": "724002", "school": "國立聯合大學", "dept": "環境與安全衛生工程學系",
          "ratios": { "chi": 0, "eng": 3, "math": 3, "pro1": 3, "pro2": 3 }, "change": "無變更",
          "screening": ["數學(5)", "英文(9)", "國文(11)", "專一專二(14)"],
          "extraTiebreakers": ["級分和(30)"],
          "tiebreakerV": { "chi": false, "eng": true, "math": true, "pro1": true, "pro2": true },
          "quota": 9
      }
    ];

    /*************************************************
     * B) PDF 校正表（已整理成你這批資料會用到的）
     *************************************************/
    const mechPdfFix = {
      "國立中山大學|機械與機電工程學系": {
        dept: "機械與機電工程學系",
        screening: ["英文(10)", "數學(13)", "專一專二(26)"],
        extraTiebreakers: ["級分和(55)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立虎尾科技大學|機械與電腦輔助工程系": {
        dept: "機械與電腦輔助工程系",
        screening: ["國文(8)", "數學(6)", "專二(10)"],
        extraTiebreakers: ["級分和(41)", "總級分(36)", "總級分(30)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立虎尾科技大學|材料科學與工程系": {
        dept: "材料科學與工程系",
        screening: ["國文(5)", "英文(4)", "數學(5)", "專二(9)", "專一(8)"],
        extraTiebreakers: ["級分和(35)", "總級分(35)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立虎尾科技大學|機械設計工程系": {
        dept: "機械設計工程系",
        screening: ["國文(6)", "數學(5)", "專一(8)", "專二(9)"],
        extraTiebreakers: ["級分和(33)", "總級分(30)", "總級分(27)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立虎尾科技大學|動力機械工程系": {
        dept: "動力機械工程系",
        screening: ["國文(7)", "英文(3)", "數學(5)", "專二(8)", "專一(8)"],
        extraTiebreakers: ["級分和(31)", "總級分(27)", "總級分(22)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立虎尾科技大學|自動化工程系": {
        dept: "自動化工程系",
        screening: ["英文(4)", "專二(7)", "專一(7)"],
        extraTiebreakers: ["級分和(19)", "總級分(20)", "總級分(16)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立虎尾科技大學|飛機工程系機械組": {
        dept: "飛機工程系機械組",
        screening: ["專二(10)", "專一(11)"],
        extraTiebreakers: ["級分和(23)", "總級分(24)", "總級分(21)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立虎尾科技大學|飛機工程系機械組（1）": {
        dept: "飛機工程系機械組（1）",
        screening: ["專二(10)", "專一(11)"],
        extraTiebreakers: ["級分和(23)", "總級分(24)", "總級分(21)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立虎尾科技大學|工業管理系": {
        dept: "工業管理系",
        screening: ["英文(4)", "專二(6)", "專一(7)"],
        extraTiebreakers: ["級分和(21)", "總級分(17)", "總級分(16)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立虎尾科技大學|臥虎專班（願景計畫）": {
        dept: "臥虎專班（願景計畫）",
        screening: ["無資料"],
        extraTiebreakers: ["總級分(27)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立屏東大學|智慧機器人學系": {
        dept: "智慧機器人學系",
        screening: ["英文(6)", "數學(6)", "專二(12)", "專一(10)"],
        extraTiebreakers: ["級分和(31)", "總級分(25)", "總級分(20)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立屏東科技大學|機械工程系": {
        dept: "機械工程系",
        screening: ["英文(5)", "數學(3)", "專二(7)", "專一(7)"],
        extraTiebreakers: ["級分和(22)", "總級分(19)", "總級分(17)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立屏東科技大學|生物機電工程系": {
        dept: "生物機電工程系",
        screening: ["英文(6)", "數學(4)", "專二(8)", "專一(6)"],
        extraTiebreakers: ["級分和(22)", "總級分(20)", "總級分(18)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立屏東科技大學|材料工程系": {
        dept: "材料工程系",
        screening: ["英文(5)", "數學(4)", "專二(7)", "專一(5)"],
        extraTiebreakers: ["級分和(20)", "總級分(17)", "總級分(14)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立屏東科技大學|智慧機電學士學位學程": {
        dept: "智慧機電學士學位學程",
        screening: ["英文(7)", "數學(6)", "專二(7)", "專一(7)"],
        extraTiebreakers: ["級分和(21)", "總級分(19)", "總級分(16)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立高雄科技大學|工業工程與管理系": {
        dept: "工業工程與管理系",
        screening: ["英文(3)", "數學(4)", "專二(8)", "專一(7)"],
        extraTiebreakers: ["級分和(22)", "總級分(18)", "總級分(15)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|機械工程系": {
        dept: "機械工程系",
        screening: ["英文(5)", "數學(4)", "專二(8)", "專一(8)"],
        extraTiebreakers: ["級分和(24)", "總級分(18)", "總級分(15)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|機械工程系智能系統與控制組": {
        dept: "機械工程系智能系統與控制組",
        screening: ["英文(5)", "數學(4)", "專二(8)", "專一(8)"],
        extraTiebreakers: ["級分和(24)", "總級分(18)", "總級分(15)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|機械工程系微奈米技術組": {
        dept: "機械工程系微奈米技術組",
        screening: ["英文(5)", "數學(4)", "專二(8)", "專一(8)"],
        extraTiebreakers: ["級分和(24)", "總級分(18)", "總級分(15)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|模具工程系": {
        dept: "模具工程系",
        screening: ["英文(5)", "數學(3)", "專二(8)", "專一(7)"],
        extraTiebreakers: ["級分和(21)", "總級分(17)", "總級分(14)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|模具工程系光電模具組": {
        dept: "模具工程系光電模具組",
        screening: ["英文(5)", "數學(3)", "專二(8)", "專一(7)"],
        extraTiebreakers: ["級分和(21)", "總級分(17)", "總級分(14)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|模具工程系精微模具組": {
        dept: "模具工程系精微模具組",
        screening: ["英文(5)", "數學(3)", "專二(8)", "專一(7)"],
        extraTiebreakers: ["級分和(21)", "總級分(17)", "總級分(14)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|機電工程系精密機械組": {
        dept: "機電工程系精密機械組",
        screening: ["英文(5)", "數學(3)", "專二(7)", "專一(7)"],
        extraTiebreakers: ["級分和(21)", "總級分(16)", "總級分(13)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|機電工程系智慧自動化組": {
        dept: "機電工程系智慧自動化組",
        screening: ["英文(5)", "數學(3)", "專二(7)", "專一(7)"],
        extraTiebreakers: ["級分和(21)", "總級分(16)", "總級分(13)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|能源與冷凍空調工程系": {
        dept: "能源與冷凍空調工程系",
        screening: ["英文(6)", "數學(4)", "專二(8)", "專一(7)"],
        extraTiebreakers: ["級分和(23)", "總級分(19)", "總級分(15)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|車輛工程系": {
        dept: "車輛工程系",
        screening: ["英文(4)", "數學(3)", "專二(6)", "專一(6)"],
        extraTiebreakers: ["級分和(20)", "總級分(14)", "總級分(12)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|工業設計系": {
        dept: "工業設計系",
        screening: ["英文(9)", "數學(6)", "專二(10)", "專一(10)"],
        extraTiebreakers: ["級分和(35)", "總級分(29)", "總級分(25)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|造船及海洋工程系": {
        dept: "造船及海洋工程系",
        screening: ["英文(5)", "數學(4)", "專二(8)", "專一(6)"],
        extraTiebreakers: ["級分和(21)", "總級分(18)", "總級分(15)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|航運技術系": {
        dept: "航運技術系",
        screening: ["英文(7)", "數學(4)", "專二(8)", "專一(7)"],
        extraTiebreakers: ["級分和(24)", "總級分(23)", "總級分(19)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|輪機工程系": {
        dept: "輪機工程系",
        screening: ["英文(5)", "數學(3)", "專二(7)", "專一(6)"],
        extraTiebreakers: ["級分和(21)", "總級分(20)", "總級分(17)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立高雄科技大學|高瞻科技不分系學士學位學程": {
        dept: "高瞻科技不分系學士學位學程",
        screening: ["英文(5)", "數學(5)", "專二(9)", "專一(7)"],
        extraTiebreakers: ["級分和(22)", "總級分(18)", "總級分(15)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立清華大學|動力機械工程學系": {
        dept: "動力機械工程學系",
        screening: ["英文(8)", "數學(11)", "專二(11)"],
        extraTiebreakers: ["級分和(47)", "總級分(40)", "總級分(35)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立陽明交通大學|機械工程學系": {
        dept: "機械工程學系",
        screening: ["英文(7)", "數學(11)", "專二(12)"],
        extraTiebreakers: ["級分和(48)", "總級分(41)", "總級分(37)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立雲林科技大學|機械工程系": {
        dept: "機械工程系",
        screening: ["英文(6)", "數學(3)", "專二(6)", "專一(6)"],
        extraTiebreakers: ["級分和(20)", "總級分(17)", "總級分(14)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立雲林科技大學|環境與安全衛生工程系": {
        dept: "環境與安全衛生工程系",
        screening: ["英文(10)", "專一專二(24)"],
        extraTiebreakers: ["級分和(39)", "總級分(32)", "總級分(28)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立雲林科技大學|營建工程系": {
        dept: "營建工程系",
        screening: ["英文(9)", "數學(6)", "專二(10)", "專一(10)"],
        extraTiebreakers: ["級分和(35)", "總級分(31)", "總級分(27)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立雲林科技大學|工業工程與管理系": {
        dept: "工業工程與管理系",
        screening: ["英文(5)", "數學(4)", "專二(9)", "專一(7)"],
        extraTiebreakers: ["級分和(24)", "總級分(20)", "總級分(17)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立雲林科技大學|工業設計系": {
        dept: "工業設計系",
        screening: ["國文(7)", "英文(10)", "數學(8)", "專二(13)", "專一(16)"],
        extraTiebreakers: ["級分和(54)", "總級分(46)", "總級分(40)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立雲林科技大學|智慧機器人學士學位學程": {
        dept: "智慧機器人學士學位學程",
        screening: ["英文(7)", "數學(4)", "專二(7)", "專一(7)"],
        extraTiebreakers: ["級分和(24)", "總級分(19)", "總級分(15)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立勤益科技大學|機械工程系": {
        dept: "機械工程系",
        screening: ["英文(4)", "數學(3)", "專二(5)", "專一(5)"],
        extraTiebreakers: ["級分和(18)", "總級分(14)", "總級分(11)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立勤益科技大學|冷凍空調與能源系能源應用組": {
        dept: "冷凍空調與能源系能源應用組",
        screening: ["英文(6)", "數學(5)", "專二(7)", "專一(7)"],
        extraTiebreakers: ["級分和(25)", "總級分(19)", "總級分(16)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立勤益科技大學|冷凍空調與能源系環境控制組": {
        dept: "冷凍空調與能源系環境控制組",
        screening: ["英文(6)", "數學(5)", "專二(7)", "專一(7)"],
        extraTiebreakers: ["級分和(25)", "總級分(19)", "總級分(16)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立勤益科技大學|工業工程與管理系": {
        dept: "工業工程與管理系",
        screening: ["英文(4)", "數學(3)", "專二(6)", "專一(5)"],
        extraTiebreakers: ["級分和(18)", "總級分(15)", "總級分(12)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立勤益科技大學|智慧自動化工程系": {
        dept: "智慧自動化工程系",
        screening: ["英文(5)", "數學(3)", "專二(5)", "專一(5)"],
        extraTiebreakers: ["級分和(18)", "總級分(14)", "總級分(11)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立彰化師範大學|電機與機械科技學系": {
        dept: "電機與機械科技學系",
        screening: ["英文(5)", "數學(7)", "專二(9)"],
        extraTiebreakers: ["級分和(38)", "總級分(30)", "總級分(25)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立臺北科技大學|機械工程系": {
        dept: "機械工程系",
        screening: ["英文(4)", "數學(7)", "專二(9)", "專一(10)"],
        extraTiebreakers: ["級分和(32)", "總級分(28)", "總級分(24)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立臺北科技大學|能源與冷凍空調工程系": {
        dept: "能源與冷凍空調工程系",
        screening: ["英文(6)", "數學(8)", "專二(10)", "專一(10)"],
        extraTiebreakers: ["級分和(38)", "總級分(29)", "總級分(25)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立臺北科技大學|材料及資源工程系材料組": {
        dept: "材料及資源工程系材料組",
        screening: ["國文(6)", "英文(6)", "數學(7)", "專二(9)", "專一(9)"],
        extraTiebreakers: ["級分和(31)", "總級分(25)", "總級分(22)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立臺北科技大學|材料及資源工程系資源組": {
        dept: "材料及資源工程系資源組",
        screening: ["國文(6)", "英文(6)", "數學(7)", "專二(9)", "專一(9)"],
        extraTiebreakers: ["級分和(31)", "總級分(25)", "總級分(22)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立臺北科技大學|工業工程與管理系": {
        dept: "工業工程與管理系",
        screening: ["英文(3)", "數學(7)", "專二(10)", "專一(9)"],
        extraTiebreakers: ["級分和(30)", "總級分(26)", "總級分(22)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立臺北商業大學|創意科技與產品設計系（桃園校區）": {
        dept: "創意科技與產品設計系（桃園校區）",
        screening: ["國文(6)", "英文(3)", "數學(4)", "專二(8)", "專一(8)"],
        extraTiebreakers: ["級分和(19)", "總級分(20)", "總級分(18)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立臺東專科學校|動力機械科產業機械組": {
        dept: "動力機械科產業機械組",
        screening: ["英文(3)", "數學(3)", "專二(4)", "專一(3)"],
        extraTiebreakers: ["級分和(14)", "總級分(10)", "總級分(8)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立臺東專科學校|動力機械科車輛組": {
        dept: "動力機械科車輛組",
        screening: ["英文(3)", "數學(3)", "專二(4)", "專一(3)"],
        extraTiebreakers: ["級分和(14)", "總級分(10)", "總級分(8)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立臺灣科技大學|機械工程系": {
        dept: "機械工程系",
        screening: ["英文數學(25)", "專一專二(26)"],
        extraTiebreakers: ["級分和(66)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立臺灣科技大學|材料科學與工程系": {
        dept: "材料科學與工程系",
        screening: ["英文(9)", "數學(8)", "專二(10)", "專一(11)"],
        extraTiebreakers: ["級分和(39)", "總級分(34)", "總級分(30)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立臺灣師範大學|機電工程學系": {
        dept: "機電工程學系",
        screening: ["英文(9)", "數學(9)", "專二(12)", "專一(10)"],
        extraTiebreakers: ["級分和(42)", "總級分(36)", "總級分(33)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立臺灣海洋大學|機械與機電工程學系": {
        dept: "機械與機電工程學系",
        screening: ["英文(5)", "數學(6)", "專二(8)", "專一(7)"],
        extraTiebreakers: ["級分和(23)", "總級分(21)", "總級分(18)"],
        tiebreakerV: { chi: true, eng: true, math: true, pro1: true, pro2: true }
      },

      "國立聯合大學|機械工程學系": {
        dept: "機械工程學系",
        screening: ["英文(5)", "數學(4)", "專二(6)", "專一(6)"],
        extraTiebreakers: ["級分和(22)", "總級分(17)", "總級分(14)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      },
      "國立聯合大學|環境與安全衛生工程學系": {
        dept: "環境與安全衛生工程學系",
        screening: ["英文(6)", "數學(4)", "專二(9)", "專一(8)"],
        extraTiebreakers: ["級分和(23)", "總級分(21)", "總級分(18)"],
        tiebreakerV: { chi: false, eng: true, math: true, pro1: true, pro2: true }
      }
    };

    /*************************************************
     * C) 名稱標準化 + 刪除非機械群01兩筆 + 套用PDF校正
     *************************************************/
    function _normBase(s) {
      return (s ?? "")
        .toString()
        .replace(/台/g, "臺")
        .replace(/\(/g, "（")
        .replace(/\)/g, "）")
        .replace(/\s+/g, "");
    }

    function _normDept(dept) {
      let d = _normBase(dept);
      d = d.replace("智動化組", "智慧自動化組");
      d = d.replace(/（\s*(\d+)\s*）/g, "（$1）");
      return d;
    }

    function _makeKey(school, dept) {
      return `${_normBase(school)}|${_normDept(dept)}`;
    }

    // 你指定要刪掉的兩筆（不屬於機械群01）
    const removeKeys = new Set([
      _makeKey("國立金門大學", "運動與休閒學系"),
      _makeKey("國立臺北護理健康大學", "運動保健系"),
    ]);

    // ✅ 最終輸出（你系統要用的 mechanicalData）
    const mechanicalData = mechanicalDataRaw
      .filter(item => !removeKeys.has(_makeKey(item.school, item.dept)))
      .map(item => {
        const schoolN = _normBase(item.school);
        const deptN = _normDept(item.dept);
        const key = `${schoolN}|${deptN}`;
        const fix = mechPdfFix[key];

        // 先做名稱標準化（即使找不到 fix 也先修正）
        const base = {
          ...item,
          school: schoolN,
          dept: deptN
        };

        if (!fix) return base;

        return {
          ...base,
          dept: fix.dept,
          screening: fix.screening,
          extraTiebreakers: fix.extraTiebreakers ?? base.extraTiebreakers,
          tiebreakerV: fix.tiebreakerV
        };
      });

    /*************************************************
     * D) UI：查詢 + 篩選 + 顯示
     *************************************************/
    const subjectLabels = {
      chi: "國文",
      eng: "英文",
      math: "數學",
      pro1: "專一",
      pro2: "專二"
    };
    const subjectShortLabels = {
      chi: "國",
      eng: "英",
      math: "數",
      pro1: "專一",
      pro2: "專二"
    };

    function renderTiebreakerFormula(item) {
      if (!item.tiebreakerV) return { text: "—", isEmpty: true };

      const order = ["chi", "eng", "math", "pro1", "pro2"];
      const active = order.filter(k => item.tiebreakerV?.[k]).map(k => subjectShortLabels[k]);

      if (active.length === 0) return { text: "無同級分採計資料", isEmpty: true };
      return { text: `(${active.join("+")})級分和`, isEmpty: false };
    }

    function tag(text) {
      return (
        <span className="inline-flex items-center rounded-full bg-slate-100 text-slate-800 px-2 py-0.5 text-xs mr-1 mb-1 border border-slate-200">
          {text}
        </span>
      );
    }

    const App = () => {
      const [filters, setFilters] = React.useState({
        chi: false, eng: false, math: false, pro1: false, pro2: false
      });
      const [strictMode, setStrictMode] = React.useState(true);
      const [searchTerm, setSearchTerm] = React.useState("");

      const toggleFilter = (k) => setFilters(prev => ({ ...prev, [k]: !prev[k] }));

      const resetFilters = () => {
        setFilters({ chi: false, eng: false, math: false, pro1: false, pro2: false });
        setSearchTerm("");
      };

      const activeFilterKeys = Object.keys(filters).filter(k => filters[k]);

      const filteredData = React.useMemo(() => {
        const q = searchTerm.trim().toLowerCase();
        return mechanicalData
          .filter(item => {
            if (!q) return true;
            const hay = `${item.school} ${item.dept} ${item.id}`.toLowerCase();
            return hay.includes(q);
          })
          .filter(item => {
            if (activeFilterKeys.length === 0) return true;
            const flags = item.tiebreakerV || {};
            if (strictMode) {
              // 嚴格：必須包含全部勾選科目
              return activeFilterKeys.every(k => !!flags[k]);
            }
            // 寬鬆：包含任一勾選科目
            return activeFilterKeys.some(k => !!flags[k]);
          })
          .sort((a,b) => (a.school + a.dept).localeCompare(b.school + b.dept, "zh-Hant"));
      }, [searchTerm, filters, strictMode]);

      return (
        <div className="max-w-6xl mx-auto px-4 py-6">
          <div className="bg-white rounded-2xl shadow-sm border border-slate-200 p-5">
            <div className="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
              <div>
                <h1 className="text-xl md:text-2xl font-bold text-slate-900">
                  115學年度 機械群01 甄選入學查詢系統
                </h1>
                <p className="text-slate-600 text-sm mt-1">
                  已依兩份 PDF（第一階段篩選標準／同級分超額篩選）全面校正，並移除非機械群01兩筆。
                </p>
              </div>

              <div className="flex gap-2">
                <button
                  onClick={resetFilters}
                  className="px-3 py-2 rounded-xl border border-slate-200 bg-white hover:bg-slate-50 text-slate-700 text-sm"
                >
                  <i className="fa-solid fa-rotate-left mr-2"></i>重設
                </button>
              </div>
            </div>

            <div className="mt-4 grid grid-cols-1 md:grid-cols-3 gap-3">
              <div className="md:col-span-2">
                <div className="flex items-center gap-2 bg-slate-50 border border-slate-200 rounded-xl px-3 py-2">
                  <i className="fa-solid fa-magnifying-glass text-slate-400"></i>
                  <input
                    value={searchTerm}
                    onChange={(e)=>setSearchTerm(e.target.value)}
                    placeholder="搜尋：學校 / 科系 / 代碼（例如：虎尾、機械、1050...）"
                    className="w-full bg-transparent outline-none text-slate-800"
                  />
                </div>
              </div>

              <div className="flex items-center justify-between md:justify-end gap-3 bg-slate-50 border border-slate-200 rounded-xl px-3 py-2">
                <div className="text-sm text-slate-700">
                  <span className="font-medium">篩選模式：</span>
                  <span className="mono">{strictMode ? "AND(全包含)" : "OR(任一)"}</span>
                </div>
                <button
                  onClick={()=>setStrictMode(s=>!s)}
                  className="px-3 py-1.5 rounded-lg bg-white border border-slate-200 hover:bg-slate-100 text-sm"
                >
                  切換
                </button>
              </div>
            </div>

            <div className="mt-4 flex flex-wrap items-center gap-2">
              <span className="text-sm text-slate-700 font-medium mr-2">同級分超額篩選科目：</span>
              {Object.keys(subjectLabels).map(k => (
                <button
                  key={k}
                  onClick={()=>toggleFilter(k)}
                  className={[
                    "px-3 py-1.5 rounded-full text-sm border transition",
                    filters[k]
                      ? "bg-slate-900 text-white border-slate-900"
                      : "bg-white text-slate-700 border-slate-200 hover:bg-slate-50"
                  ].join(" ")}
                >
                  {subjectLabels[k]}
                </button>
              ))}
              <span className="ml-auto text-sm text-slate-600">
                顯示筆數：<span className="font-semibold text-slate-900">{filteredData.length}</span>
              </span>
            </div>
          </div>

          <div className="mt-4 space-y-3">
            {filteredData.map(item => {
              const tb = renderTiebreakerFormula(item);

              return (
                <div key={item.id} className="bg-white rounded-2xl shadow-sm border border-slate-200 p-5">
                  <div className="flex flex-col md:flex-row md:items-start md:justify-between gap-3">
                    <div>
                      <div className="flex items-center gap-2 flex-wrap">
                        <span className="text-slate-900 font-bold text-lg">{item.school}</span>
                        <span className="text-slate-500 text-sm mono">#{item.id}</span>
                        <span className="text-xs px-2 py-0.5 rounded-full bg-emerald-50 text-emerald-700 border border-emerald-200">
                          名額：{item.quota ?? "—"}
                        </span>
                        <span className="text-xs px-2 py-0.5 rounded-full bg-slate-50 text-slate-700 border border-slate-200">
                          變更：{item.change ?? "—"}
                        </span>
                      </div>

                      <div className="mt-1 text-slate-800 font-semibold">
                        {item.dept}
                      </div>

                      <div className="mt-3">
                        <div className="text-sm text-slate-700 font-medium mb-1">第一階段篩選標準（PDF）</div>
                        <div className="flex flex-wrap">
                          {(item.screening || []).map((s, idx) => <React.Fragment key={idx}>{tag(s)}</React.Fragment>)}
                        </div>
                      </div>

                      <div className="mt-3">
                        <div className="text-sm text-slate-700 font-medium mb-1">同級分超額篩選標準（PDF）</div>
                        <div className="flex flex-wrap items-center gap-2">
                          <span className={["mono text-sm px-2 py-1 rounded-lg border",
                            tb.isEmpty ? "bg-slate-50 text-slate-500 border-slate-200" : "bg-indigo-50 text-indigo-700 border-indigo-200"
                          ].join(" ")}>
                            {tb.text}
                          </span>

                          <div className="text-xs text-slate-600">
                            {item.extraTiebreakers?.length ? (
                              <span>
                                其他門檻：{" "}
                                <span className="mono text-slate-800">
                                  {item.extraTiebreakers.join(" / ")}
                                </span>
                              </span>
                            ) : (
                              <span className="italic">—</span>
                            )}
                          </div>
                        </div>
                      </div>
                    </div>

                    <div className="md:w-72">
                      <div className="text-sm text-slate-700 font-medium mb-2">採計倍率（僅供參考）</div>
                      <div className="grid grid-cols-2 gap-2">
                        {["chi","eng","math","pro1","pro2"].map(k => (
                          <div key={k} className="bg-slate-50 border border-slate-200 rounded-xl px-3 py-2">
                            <div className="text-xs text-slate-500">{subjectLabels[k]}</div>
                            <div className="text-lg font-bold text-slate-900 mono">{item.ratios?.[k] ?? "—"}</div>
                          </div>
                        ))}
                      </div>
                    </div>
                  </div>
                </div>
              );
            })}

            {filteredData.length === 0 && (
              <div className="bg-white rounded-2xl shadow-sm border border-slate-200 p-8 text-center text-slate-600">
                <i className="fa-regular fa-face-meh text-2xl mb-2"></i>
                <div>沒有符合條件的結果</div>
              </div>
            )}
          </div>

          <div className="mt-6 text-xs text-slate-500 text-center">
            ※ 本頁面資料已依 PDF 校正；若你要我把「倍率 ratios / quota」也一起對 PDF 再核一次，直接把那份 PDF 再丟我。
          </div>
        </div>
      );
    };

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
